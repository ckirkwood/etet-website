<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" href="favicon.png" sizes="16x16 32x32" type="image/png"> 
  <title>every thing every time</title>
  <link rel="icon" href="favicon.png" sizes="16x16 32x32" type="image/png">
  <meta name="description" content="every thing every time, a new artwork by Naho Matsuda">
  <meta name="keywords" content="data poetry, smart cities, IoT, digital art, CityVerve">
  <meta name="author" content="Naho Matsuda">
  <meta name="google-site-verification" content="GL8M6FvDHraxe692s0j-3AIX-HBxSwwY9En-kvyi8ko" />
  <link href="style.css" type="text/css" rel="stylesheet">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <script type="text/javascript" src="date_time.js"></script>
  <script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-39744159-4', 'auto');
  ga('send', 'pageview');

  </script>
</head>


<body>

  <div class="background-image"></div>

  <ul class="navigation">
    <li class="nav-item"><a href="index.html">poem</a></li>
    <li class="nav-item"><a href="about.html">about</a></li>
    <li class="nav-item"><a href="locations.html">locations</a></li>
    <li class="nav-item"><a href="events.html">events</a></li>
    <li class="nav-item"><a href="contact.html">contact</a></li>
  </ul>

  <input type="checkbox" id="nav-trigger" class="nav-trigger" />
  <label for="nav-trigger"></label>

  <div class="site-wrap">
  <div class="site-wrap-bg"></div>

    <div id="title">
      <h1><a href="index.html">every thing every time</a></h1>
    </div>


    <div id="controls">
      <form action="">
        Choose location:<br>
        <input type="radio" name="location" checked value="none"> None<br> <!-- checked by default -->
        <input type="radio" name="location" value="university"> University Place<br>
        <input type="radio" name="location" value="citylabs"> CityLabs 1.0<br>
        <input type="radio" name="location" value="library"> Manchester Central Library<br>
        <input type="radio" name="location" value="gardens"> Hulme Community Garden Centre<br>
      </form>
    </div>



    <br />
    <div id="container">
      <div id="date_time"></div>
      <div id="poem">

        poem loading...</div>

      <div id="readout"></div>
    </div>

  </body>


  <script type="text/javascript">window.onload = date_time('date_time');</script>
  </div>

  <script type="text/javascript">
    var poemDiv = document.getElementById('poem');
    var readoutDiv = document.getElementById('readout');
    var currentTicks = 0;
    var maxTicks = 60;
    getPoem = function() {
      var url;
        url = "http://everythingeverytime.herokuapp.com/poem";
      fetch(url + getLocation())
      .then((resp) => resp.json())
      .then(function(data) {
        printPoem(data);
      })
    }
    getLocation = function() {
      var checkedElement = document.querySelector('input[name="location"]:checked').value;
      return "?location=" + checkedElement;
    }
    printPoem = function(data) {
      poemDiv.innerHTML = "";
      for(var i = 0; i < data.poem.length; i++) {
        poemDiv.innerHTML = poemDiv.innerHTML + data.poem[i] + "<br />";
      }
    }
    updateCounter = function() {
      if(currentTicks < maxTicks) {
        currentTicks++;
      } else {
        currentTicks = 0;
        poemDiv.innerHTML = "poem loading...";
        getPoem();
      }
      readoutDiv.innerHTML = "Refreshing in " + (maxTicks - currentTicks) + " seconds";
    }
    setInterval(function() {
      updateCounter();
    }, 1000);
    getPoem();
  </script>
</html>
